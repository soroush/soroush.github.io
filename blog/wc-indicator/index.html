
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>مستراح‌بان (: - اختاپوس خسته</title>
  <meta name="author" content="سروش">

  
  <meta name="description" content="پروژهٔ «مستراح‌بان» اسمی هست که روی یکی از پروژه‌های جالب و البته بسیار به‌دردبخور که اخیراً کار کردم گذاشتم (:
این پروژه تلاشی بود برای حل یکی از &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://soroush.github.io/blog/wc-indicator">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="اختاپوس خسته" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="https://fonts.googleapis.com/css?family=Inconsolata|PT+Serif|PT+Serif+Caption" rel="stylesheet">
<!--- MathJax Configuration -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44259177-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">اختاپوس خسته</a></h1>
  
    <h2>یادداشت‌هایی پیرامون کد، زندگی و دوستان</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
  
  
  
  
<ul class="subscription">
  <li><a href="https://github.com/soroush" rel="subscribe-github" title="@soroush در گیت‌هاب">گیت‌هاب</a></li>
</ul>
  
  
  
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:soroush.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="جستجو"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">بلاگ</a></li>
  <li><a href="/blog/archives">بایگانی</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">مستراح‌بان (:</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2017-05-29T00:00:00+04:30" pubdate data-updated="true">۸ 
      خرداد 
      ۱۳۹۶</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>پروژهٔ «مستراح‌بان» اسمی هست که روی یکی از پروژه‌های جالب و البته بسیار به‌دردبخور که اخیراً کار کردم گذاشتم (:
این پروژه تلاشی بود برای حل یکی از معضلات شرکت ما که البته همگی ازش شاکی هستیم اما در موردش صحبت نمی‌کنیم:
مشکل کمبود سرویس‌های بهداشتی.</p>

<p>این پروژه کاملاً الکترونیکی بود و من هیچ تخصصی در زمینهٔ الکترونیک ندارم. برای همین برام خیلی سخت بود که
با مفاهیم مرتبط کار کنم و درکشون کنم. البته مقدار زیادی از دوستانم که متخصص الکترونیک هستند کمک گرفتم.</p>

<!--more-->


<h2>صورت‌مسأله</h2>

<p>ما توی شرکت فقط یه سرویس بهداشتی برای هر طبقه داریم.
یعنی یکی برای هر ۱۶ تا ۲۰ نفر. خوب این باعث میشه که خیلی از مواقع هنگام رجوع به مکان موردنظر
به در بسته بخوریم. اگر به میزان کافی بدشانس باشیم ممکنه در طول روز چندین بار مراجعه کنیم. مشکل وقتی خیلی حاد میشه که
مراجعات ما دقیقاً روی زمان‌هایی که کس دیگری داخل هست انجام بشه.
این یک مسألهٔ کلاسیک توی سیستم‌عامل هست به اسم
<a href="https://fa.wikipedia.org/wiki/%DA%AF%D8%B1%D8%B3%D9%86%DA%AF%DB%8C_%D9%85%D9%86%D8%A7%D8%A8%D8%B9"><strong>گرسنگی</strong></a>
یا همون
<a href="https://en.wikipedia.org/wiki/Starvation_(computer_science"><strong>Starvation</strong></a>).</p>

<p>برای حل این مشکل روش‌های متعددی وجود داره.
مثلا میشه تعداد سرویس‌های بهداشتی رو بیشتر کرد. (در حالت ایده‌آل یکی به‌ازای هر نفر) اما خوب محدودیت‌هایی هست
که اجازه نمیده این کار رو انجام بدیم. مثلاً این که اگر شرکت نیروی جدیدی گرفت باید براش یک سرویس جدید بسازیم. و این یعنی کلی کار ساختمونی .</p>

<h2>راه حل پیشنهادی</h2>

<p>راه حل یک سرویس برای هر نفر با شکست مواجه شد.
بنابراین من و همکارانم در طول ماه‌های گذشته در مورد راه‌حل‌های دیگه برای این مسأله همیشه بحث و بررسی می‌کردیم.
یکی از راه حل‌های خوبی که برای این مشکل پیشنهاد شد این بود که مکانیزمی طراحی کنیم که
هرکسی قبل از بلند شدن از سرجای خودش بتونه از وضعیت سرویس اطلاع پیدا کنه. برای این کار من یک روشی پیشنهاد دادم شامل یک فرستنده و تعدادی
گیرنده. فرستنده به قفل در وصل میشه و هر وقت کسی در سرویس بهداشتی رو از پشت بست
شروع می‌کنه به ارسال پیام. این پیام به سادگی شامل یک اطلاعات ساده هست که مشخص می‌کنه که کسی داخل هست یا نه.
و وقتی که قفل در باز شد، ارسال پیام متوقف میشه. به این ترتیب گیرنده‌ها زمانی که کسی داخل سرویس نیست فقط یک
چراغ سبز و زمانی که کسی داخل هست یک چراغ قرمز چشمک‌زن رو روشن خواهد کرد.</p>

<p>طرح پیشنهادی از اجزای الکترونیکی خیلی ساده استفاده می‌کنه. بعدها میشه این طرح رو گسترش داد و چیزهای باحال‌تری مثل
وای‌فای بهش اضافه کرد. وای‌فای مربوطه می‌تونه یک وب‌سرویس از سرورهای پورتال رو صدا بزنه و اعلام وضعیت کنه.
به این ترتیب افراد شرکت وضعیت دسشویی‌های هر طبقه رو می‌تونن توی پورتال عمومی
مشاهده کنند و مثلاً برن یه طبقهٔ دیگه.</p>

<h2>جزئیات و مدار</h2>

<p>دو مدار ساده برای این کار طراحی کردم که یک فرستنده و یک گیرنده هستند.
پروتکل ارتباطی بین این دو بورد از نوع
<a href="https://en.wikipedia.org/wiki/70-centimeter_band">433 Mhz</a>
با
<a href="https://fa.wikipedia.org/wiki/%DA%A9%D9%84%DB%8C%D8%AF%DA%AF%D8%B0%D8%A7%D8%B1%DB%8C_%D8%AA%D8%BA%DB%8C%DB%8C%D8%B1_%D8%AF%D8%A7%D9%85%D9%86%D9%87">مدولاسیون تغییر دامنه</a>
که با قیمت ارزونی در دسترس هست. در ادامه جزئیات این بوردها و قطعات رو توضیح میدم.</p>

<h3>فرستنده</h3>

<p>برای درست کردن یک مدار چشمک‌زن راه‌های زیادی وجود داره. می‌تونیم از یک میکروکنترلر سادهٔ هشت‌بیتی
و هشت‌پایه (مثلاً
<a href="https://www.sparkfun.com/products/9378">ATTiny</a>
) استفاده کرد. اما راه‌های ساده‌تر و ارزون‌تری هم وجود داره.
مثلاً استفاده از آی‌سی فوق‌العاده به‌دردبخور و ارزون‌قیمت
<a href="https://www.sparkfun.com/products/9273">تایمر 555</a>
که می‌تونه با تغییر مقاومت‌ها و خازن‌های متصل به پایه‌ها موج مربعی با فرکانس‌های مختلف
تولید کنه.</p>

<p>من این موج سیگنال تولید شده رو مستقیم وصل کردم به فرستنده و البته سر راهش یه
انشعاب هم گرفتم به یه دیود نوری که با یه ترانزیستور درایو میشه. مدار کامل رو می‌تونید توی شکل ببینید.
(برای دیدن سایز واقعی روی تصویر کلیک کنید)
<a href="/images/posts/wc-watcher/transmitter-color.png"><img class="center" src="/images/posts/wc-watcher/transmitter-color.png" title="مدار فرستندهٔ مستراح‌بان" ></a></p>

<p>اما بورد این مدار چالش خیلی پیچیده‌تری بود. اول سعی کردم بورد رو به شکل یک‌لایه طراحی کنم که هزینه‌ش
کمتر بشه. بعدها حس کردم که نمیشه یک‌لایه باشه! بعد روشی پیدا کردم که اثبات می‌کرد چه گراف‌هایی می‌تونن
مسطح باشن. (در مورد گراف‌های غیرمسطح اما نظری نمیده) این قضیه میگه که اگر گرافی شرط زیر رو داشته باشه
<strong>می‌تونه</strong> مسطح باشه:</p>

<p>$$e \leq 3v-6$$</p>

<p>(برای توضیحات بیشتر می‌تونید صفحهٔ ویکی‌پدیای
<a href="https://fa.wikipedia.org/wiki/%DA%AF%D8%B1%D8%A7%D9%81_%D9%85%D8%B3%D8%B7%D8%AD">گراف‌های مسطح</a>
رو ببینید.)</p>
</div>


  <footer>
    <p class="meta">
      
  



  <span class="byline author vcard">نوشته شده توسط <span class="fn">
  
    سروش
  
  </span></span>


      








  


<time datetime="2017-05-29T00:00:00+04:30" pubdate data-updated="true">۸ 
      خرداد 
      ۱۳۹۶</time>
      

<span class="categories">
  
    <a class='category' href='/categories/electronics-fun-prwjh-lkhtrwnykh/'>electronics,fun,پروژه,الکترونیک</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://soroush.github.io/blog/wc-indicator/" data-via="gigtupus" data-counturl="http://soroush.github.io/blog/wc-indicator/" >توئیت</a>
  
  
  <div class="g-plusone" data-size="small"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment right" href="/blog/worst-ever-bug/" title="پست قبلی: بدترین باگ کیوت!">&laquo; بدترین باگ کیوت!</a>
      
      
        <a class="basic-alignment left" href="/blog/calendaring-in-qt/" title="پست بعدی: تقویم هجری شمسی در کیوت">تقویم هجری شمسی در کیوت &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>دیدگاه‌ها</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  حق تألیف &copy; 2017 - سروش -
  <span class="credit">قدرت‌گرفته از <a href="http://octopress.org">اکتوپرس</a> | براساس طرح <a href="https://github.com/lucaslew/whitespace">فضای سفید</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'soroushr';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://soroush.github.io/blog/wc-indicator/';
        var disqus_url = 'http://soroush.github.io/blog/wc-indicator/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>








  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
