<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fa-ir" lang="fa-ir">
<head>
  <link href="//gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.68.3" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>چطور پازل 8 را به روش ‪C&#43;&#43;‬ حل کنیم &middot; اختاپوس خسته</title>

  
  <link type="text/css" rel="stylesheet" href="https://soroush.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://soroush.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://soroush.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://soroush.github.io/css/hyde.css">
  <link type="text/css" rel="stylesheet" href="https://soroush.github.io/css/all.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_SVG">
</script> 
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    "HTML-CSS": {
    styles: {
        ".MathJax .mo, .MathJax .mi": {color: "black ! important"}
    }
    }
});
</script> 




</head>

  <body class=" layout-reverse">
  <aside class="sidebar">
  <div class="container sidebar-sticky-top">
    <div class="sidebar-about">
       <img style="border-radius:50%; background:#fafafa" src="https://soroush.github.io/static/images/octo.svg" alt="Avatar">
    </div>
  </div>
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://soroush.github.io/"><h1>اختاپوس خسته</h1></a>
      <p class="lead">
       یادداشت‌هایی دربارهٔ برنامه‌نویسی و زندگی 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://soroush.github.io/">صفحهٔ اول</a> </li>
        <li><a href="https://github.com/soroush/">&#x202d;<i class="fab fa-github"></i> soroush&#x202c;</a></li>
        
      </ul>
    </nav>

    <p>حقوق نشر محفوظ است.</p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>چطور پازل 8 را به روش ‪C&#43;&#43;‬ حل کنیم</h1>

  <time datetime=2014-03-21T00:00:00Z class="post-date">جمعه، ۱ فروردین ۱۳۹۳</time>
  <p>اولین روز سال ۱۳۹۳ و اولین پست همین سال :) برای شروع سال چه چیزی بهتر از یه پازل
فکری می‌تونه باشه؟ امروز جمعه‌ست و اول سال با آخر هفته شروع شده. آخرهفته‌ها فرصت
مناسبی برای پروژه‌های کوچیک و جالب هست. خوب
<a href="http://www.zoomit.ir">زومیت</a>
زحمت کشیده و
<a href="http://www.zoomit.ir/howto/puzzle/10159-puzzle-thirty-one">پازل شمارهٔ ۳۱ام</a>
رو روز اول فروردین منتشر کرده. توی این پست می‌خوام توضیح بدم که چطوری این پازل
رو حل کردم. در واقع تقلب کردم. چون اولش یک برنامه‌ای نوشتم که پازل رو حل کنه :P
بعد رابطه‌ای برای تولید جواب‌ها پیدا کردم که خیلی سخت‌تر از روش اول جواب می‌داد.
منتها خوبیش اینه که اجازه میده تعداد جواب‌های موجود رو محاسبه کنیم. تعداد کل
جواب‌ها ۳۸ تا خواهد بود منتها با روش ریاضیاتی محاسبهٔ این جواب‌ها تقریباً غیر
ممکن‌ه ولی با brute force امیدواری بیشتر میشه!</p>
<p>جایزهٔ این پازل یک عدد هارد دیسک بسیار عالی هست که امیدوارم توی قرعه‌کشی قبول
بشم.</p>
<p><em>یادداشت:</em> شما قبل از پنجشنبه ساعت ۱۲ ظهر (آخرین مهلت ارسال جواب‌ها) نمی‌تونید
این پست رو بخونید! ولی دارم اینو اول فروردین می‌نویسم.</p>
<!-- raw HTML omitted -->
<h1 id="صورتمسأله">صورت‌مسأله</h1>
<p>خوب اول از همه باید صورت‌مسأله رو بفهمیم: با استفاده از ۸ تا عدد هشت و عملگرهای
ریاضی، عدد ۱۰۰۰ رو تولید کنید. ساده به نظر می‌رسه اما نیست! مسأله پیدا کردن یک
چندجمله‌ای با ضرایب ۸ و متغیرهای ۸ هست که مجموع تعداد متغیرها و ضرایب برابر با ۸
باشه. و یا به‌عبارت دیگر، پیدا کردن یک چندجمله‌ای از هشت تا هشت با ضرایب ثابتِ
یک. راه حل ساده‌ای برای مسأله وجود نداره بنابراین میریم سراغ راه حل زورِ خری
(brute force).
پیشنهاد اولیهٔ من اینه که تمام دنباله‌های postfix با استفاده از 8، +، -، / و *
درست کنیم، هر کدوم رو ارزیابی کنیم، اگه برابر با ۱۰۰۰ شد، به‌عنوان یک جواب قبولش
کنیم. تا همین‌جا کلی مشکل وجود داره! اول از همه ممکنه بپرسید که خوب چرا postfix
؟ چرا همون infix سادهٔ خودمون رو استفاده نمی‌کنیم؟ خوب دلیلش اینه که ارزیابی
عبارات postfix ساده‌تره. فقط کافیه بریزیم روی یه پشته و دونه دونه محاسبه کنیم و
جایگزین کنیم.</p>
<h1 id="و-اما-مشکلات">و اما مشکلات!</h1>
<p>اولین مشکل اینه که راه حلی برای تولید عبارات معتبر ندارم. (و اصولاً پردازش
اعتبارش هم صرف نمی‌کنه) مگر این که کسی بیاد و ادعا کنه که یک عبارت منظم ساده
برای اعتبارسنجی عبارات پسوندی درست کرده. تازه اونم شاید (فقط شاید!) پردازش کمتری
رو در مجموع انجام بده. اصلاً چرا شاید؟ قطعاً پردازش بیشتری خواهد داشت! خود
ارزیابی عبارت (محاسبهٔ مقدارش) خیلی سریع‌تر از چک کردن اعتبار عبارت خواهد بود.
پس با این حساب بی‌خیال مشکل اول میشیم و عبارت‌هایی مثل عبارات زیر رو هم ارزیابی
می‌کنیم:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">+*/+8*8*+8+8/-8
+++++++---++</code></pre></div>
<p>توضیح این که اولی غلطه چون اصلا با عملگر شروع شده! دومی هم غلطه چون اصلاً عملوند
نداره! خوب من نمیام بررسی کنم ببینم کدوم عبارت درسته کدوم غلطه. بلکه همین
عبارت‌های احمقانه رو هم ارزیابی می‌کنم. نهایتاً موقع ارزیابی استک پر نمیشه و
میگم حتماً عبارت غلط بوده.</p>
<p>و اما مشکل دوم! مشکل بزرگ‌تر&hellip; اندازهٔ مجموعهٔ جستجو خیلی بزرگه و ایده‌ای در
مورد اندازهٔ مجموعهٔ جواب هم نداریم! مثلاً ممکنه فقط یک جواب یکتا وجود داشته
باشه. بیاین یه حساب سرانگشتی بکنیم. اگر فرض کنیم طول رشتهٔ پسوندی ما کمتر از ۲۰
و بیشتر از ۵ باشه، در این صورت اندازهٔ مجموعه‌ای که باید پردازش کنیم برابر خواهد
بود با:
$$S=\sum_{i=5}^{20}{5^{i}}=23,841,857,909,375$$
یعنی بیست و سه تریلیارد و هشتصد و چهل و یک میلیارد و هشتصد و پنجاه و هفت میلیون
و نهصدونه‌هزار و سی‌صد و پنجاه و هفت :D عدد خیلی بزرگی هست و برای این که بفهمیم
چقدر بزرگه باید بگم که پردازش این تعداد دنباله روی کامپیوتر نسبتاً سریع من
(پردازندهٔ Corei5) چیزی حدود ۴۰۰ سال طول می‌کشه. اما چی باعث میشه که بشینیم و
برای یه همچین مقدار بزرگی کد بنویسیم؟ خیلی ساده: شانس و کمی شهود
می‌تونم ادعا کنم که یه دنبالهٔ ۵ تایی به‌هیچ وجه نمی‌تونه عدد ۱۰۰۰ رو تولید کنه
و همین‌طور دنبالهٔ ۲۰ تایی خیلی طولانی‌یه. بنابراین سعی می‌کنم دامنهٔ جستجو رو
محدود کنم. به‌جای ۵ از ۱۰ شروع می‌کنم. همچنین اول از رشته‌های ۱۵ تایی شروع
می‌کنم چون احتمال میدم جواب اون طرف‌ها باشه. بعدش میرم سراغ ۱۴ تایی‌ها و بعد ۱۶
تایی‌ها (از مرکز به طرف بیرون). اندازهٔ اولین مجموعه که باید جواب رو توش پیدا
کنم برابر میشه با:</p>
<p>$$S'=5^{15}=30,517,578,125$$
یعنی سی‌میلیارد. برآورد می‌کردم حدود ۱۰۰ ساعت وقت لازم داشته باشم. ولی با
پردازش‌های اضافی و کمی ایجاد تغییرات توی کدها، و البته محاسبهٔ تخمینی زمان
باقی‌مانده داخل کدهای برنامه، این عدد تبدیل به ۳۰۰ ساعت شد. خوب همین مقدار
امید برای شروع کافیه :)</p>
<h1 id="کد">کد</h1>
<p>راستش اولش می‌خواستم با پایتون شروع کنم به نوشتن کدهای برنامه. ولی بعد به خودم
گفتم مرد باش! بشین با سی++ بنویس. حدود نیم ساعت بعد یه همچین چیزی درآوردم که زیر
می‌بینید. پیاده‌سازی کامل برنامه رو می‌تونید از این آدرس کلون کنید:
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">git@github.com:soroush/8-8-puzzle.git</code></pre></div>
توی این کد برای اولین بار سعی کردم یک الگوریتم بازگشتی رو به‌شکل موازی
پیاده‌سازی کنم. چیزی که اولش نوشتم چندان جالب نبود ولی بعد ایدهٔ بسیار خوبی از
سایت استک گرفتم: «هر جا تصمیم به ایجاد ترد جدید گرفتی، ورودی رو کپی کن. در بقیهٔ
موارد اشاره‌گر بده به فراخوانی‌های پایین‌تر». خیلی عالی بود! خیلی خوشم اومد.</p>
<p>قبل از توضیح کدها نتیجهٔ اجرا رو می‌خوام نشون‌تون بدم. بعد از حدود دو ساعت پردازش
تک‌هسته‌ای (روی Core2 duo) مقدار  ۰٫۱ درصد (یک هزارم!) از مجموعهٔ جستجو رو اسکن
کردم و بیست و پنج تا جواب برای مسأله پیدا کردم که خوب تعدادی‌شون هم‌ارز هستند.
برای دیدن هم‌ارزی‌شون تعدادی از جمله‌ها رو نوشتم:
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">...
8888+*888++8/-*        (8*((8*(8+8))-((8+(8+8))/8)))
8888+*88+8+8/-*        (8*((8*(8+8))-(((8+8)+8)/8)))
8888+*88+8/-*8-        ((8*((8*(8+8))-((8+8)/8)))-8)
8888+*88/-*88+-        ((8*((8*(8+8))-(8/8)))-(8+8))
8888+*88/-*8-8-        (((8*((8*(8+8))-(8/8)))-8)-8)
888+88+8/88*-*-        (8-((8+8)*(((8+8)/8)-(8*8))))
...</code></pre></div>
جواب‌های کامل رو می‌تونید
<a href="https://github.com/soroush/8-8-puzzle">این‌جا</a>
ببینید.</p>
<p>اول از همه کلاس اصلی برنامه:
<div class="highlight"><pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">class</span> <span class="nc">EightPuzzleSolver</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">EightPuzzleSolver</span><span class="p">(</span><span class="n">WINDOW</span> <span class="o">*</span><span class="n">_window</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">outFile</span><span class="p">);</span>
    <span class="o">~</span><span class="n">EightPuzzleSolver</span><span class="p">();</span>
    <span class="kt">bool</span> <span class="nf">initialize</span><span class="p">(</span><span class="k">const</span> <span class="n">size_t</span> <span class="o">&amp;</span><span class="n">start</span><span class="p">,</span> <span class="k">const</span> <span class="n">size_t</span> <span class="o">&amp;</span><span class="n">end</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">start</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">setThreadCount</span><span class="p">(</span><span class="k">const</span> <span class="n">size_t</span><span class="o">&amp;</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">getResults</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
    <span class="kt">bool</span> <span class="n">check</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">inputs</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">permutation</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">index</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">total</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">current</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">precentage</span><span class="p">;</span>
    <span class="n">uint</span> <span class="n">printLine</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">size_t</span><span class="p">,</span><span class="n">size_t</span><span class="o">&gt;</span> <span class="n">range</span><span class="p">;</span>
    <span class="n">WINDOW</span><span class="o">*</span> <span class="n">window</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">stack</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">evaluation</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">symbols</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">results</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">ofstream</span> <span class="n">outFile</span><span class="p">;</span>
    <span class="n">size_t</span> <span class="n">splitDepth</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">mutex</span> <span class="n">guard</span><span class="p">;</span>
    <span class="c1">// Timing
</span><span class="c1"></span>    <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">time_point</span> <span class="n">startTime</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
پیاده‌سازی تابع تولید جایگشت:</p>
<p><div class="highlight"><pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="n">EightPuzzleSolver</span><span class="o">::</span><span class="n">permutation</span><span class="p">(</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">index</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">index</span><span class="o">==</span><span class="n">input</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">guard</span><span class="p">.</span><span class="n">lock</span><span class="p">();</span>
        <span class="n">steady_clock</span><span class="o">::</span><span class="n">time_point</span> <span class="n">now</span> <span class="o">=</span> <span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
        <span class="k">auto</span> <span class="n">ticks</span> <span class="o">=</span> <span class="n">now</span><span class="o">-</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">startTime</span><span class="p">;</span>
        <span class="k">auto</span> <span class="n">s</span> <span class="o">=</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ticks</span><span class="p">).</span><span class="n">count</span><span class="p">()</span><span class="o">%</span><span class="mi">60</span><span class="p">;</span>
        <span class="k">auto</span> <span class="n">m</span> <span class="o">=</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">chrono</span><span class="o">::</span><span class="n">minutes</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ticks</span><span class="p">).</span><span class="n">count</span><span class="p">()</span><span class="o">%</span><span class="mi">60</span><span class="p">;</span>
        <span class="k">auto</span> <span class="n">h</span> <span class="o">=</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">chrono</span><span class="o">::</span><span class="n">hours</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ticks</span><span class="p">).</span><span class="n">count</span><span class="p">();</span>
        <span class="k">auto</span> <span class="n">ms</span> <span class="o">=</span> <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ticks</span><span class="p">).</span><span class="n">count</span><span class="p">();</span>
        <span class="n">wmove</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="o">++</span><span class="n">current</span><span class="p">;</span>
        <span class="n">precentage</span> <span class="o">=</span> <span class="mf">100.0</span><span class="o">*</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">/</span><span class="n">total</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span> <span class="n">predict</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">ms</span><span class="o">/</span><span class="n">precentage</span><span class="p">));</span>
        <span class="n">wprintw</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="s">&#34;Elapsed Time: %dh:%dm:%ds,&#34;</span> 
                   <span class="s">&#34; Remaining Time: %04dh:%02dm:%02ds,&#34;</span> 
                   <span class="s">&#34; Progress: %d of %.0lf (%.4f%%) sample: %s&#34;</span><span class="p">,</span>
                <span class="n">h</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">,</span>
                <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">hours</span><span class="o">&gt;</span><span class="p">(</span><span class="n">predict</span><span class="p">).</span><span class="n">count</span><span class="p">(),</span>
                <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">minutes</span><span class="o">&gt;</span><span class="p">(</span><span class="n">predict</span><span class="p">).</span><span class="n">count</span><span class="p">()</span><span class="o">%</span><span class="mi">60</span><span class="p">,</span>
                <span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">predict</span><span class="p">).</span><span class="n">count</span><span class="p">()</span><span class="o">%</span><span class="mi">60</span><span class="p">,</span>
                <span class="n">current</span><span class="p">,</span><span class="n">total</span><span class="p">,</span><span class="n">precentage</span><span class="p">,</span><span class="n">input</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
        <span class="n">wrefresh</span><span class="p">(</span><span class="n">window</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">wmove</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">printLine</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
            <span class="n">wprintw</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="s">&#34;%d: %s&#34;</span><span class="p">,</span><span class="n">results</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">input</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
            <span class="n">results</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
            <span class="n">outFile</span> <span class="o">&lt;&lt;</span> <span class="n">input</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
            <span class="n">wrefresh</span><span class="p">(</span><span class="n">window</span><span class="p">);</span>
            <span class="o">++</span><span class="n">printLine</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">guard</span><span class="p">.</span><span class="n">unlock</span><span class="p">();</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">splitDepth</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="kr">thread</span><span class="o">&gt;</span> <span class="n">threads</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">char</span> <span class="nl">symbol</span> <span class="p">:</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">symbols</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">input</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbol</span><span class="p">;</span>
            <span class="n">threads</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">([</span><span class="o">=</span><span class="p">]</span> <span class="p">{</span>
                <span class="n">string</span> <span class="n">cpy</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="n">permutation</span><span class="p">(</span><span class="n">cpy</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="kr">thread</span><span class="o">&amp;</span> <span class="nl">t</span><span class="p">:</span> <span class="n">threads</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">t</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">char</span> <span class="nl">symbol</span> <span class="p">:</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">symbols</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">input</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbol</span><span class="p">;</span>
            <span class="n">permutation</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
و تابع ارزیابی عبارت پسوندی:</p>
<div class="highlight"><pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">bool</span> <span class="n">EightPuzzleSolver</span><span class="o">::</span><span class="n">check</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="o">&amp;</span><span class="n">inputs</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="nl">n</span><span class="p">:</span> <span class="n">inputs</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">;</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="sc">&#39;+&#39;</span><span class="o">:</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">n1</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">n2</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="n">evaluation</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="n">n1</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">&#39;-&#39;</span><span class="o">:</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">n1</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">n2</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="n">evaluation</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">n2</span><span class="o">-</span><span class="n">n1</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">&#39;*&#39;</span><span class="o">:</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">n1</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">n2</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="n">evaluation</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">n2</span><span class="o">*</span><span class="n">n1</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">&#39;/&#39;</span><span class="o">:</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">n1</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">n2</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">n1</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="n">evaluation</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">n2</span><span class="o">/</span><span class="n">n1</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">&#39;8&#39;</span><span class="o">:</span>
            <span class="n">evaluation</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">evaluation</span><span class="p">.</span><span class="n">top</span><span class="p">()</span><span class="o">==</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>و در نهایت پیاده‌سازی تابع شروع کننده:</p>
<div class="highlight"><pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="n">EightPuzzleSolver</span><span class="o">::</span><span class="n">start</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">range</span><span class="p">.</span><span class="n">second</span><span class="p">;</span> <span class="n">length</span><span class="o">&gt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">range</span><span class="p">.</span><span class="n">first</span><span class="p">;</span> <span class="o">--</span><span class="n">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">wmove</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span><span class="n">length</span><span class="p">);</span>
        <span class="n">current</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">precentage</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
        <span class="n">wprintw</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="s">&#34;Checking strings of length: %d&#34;</span><span class="p">,</span><span class="n">length</span><span class="p">);</span>
        <span class="n">wmove</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">wprintw</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="s">&#34;Total: %.0lf&#34;</span><span class="p">,</span><span class="n">pow</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span><span class="n">length</span><span class="p">));</span>
        <span class="n">string</span> <span class="nf">input</span><span class="p">(</span><span class="n">length</span><span class="p">,</span><span class="sc">&#39;8&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">startTime</span> <span class="o">=</span> <span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
        <span class="n">permutation</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</div>

<h2>دیدگاه‌ها</h2>
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "khtpws-khsth" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </main>

    
  </body>
</html>
